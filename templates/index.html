<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>YouTube Stats Dashboard</title>

    <!-- CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='styles.css') }}"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>

  <body>
    <header>
      <h1>üìä YouTube Channel Statistics Dashboard</h1>
      <!-- <p class="subtitle">Theo d√µi l∆∞·ª£t xem v√† ng∆∞·ªùi ƒëƒÉng k√Ω theo th·ªùi gian th·ª±c</p> -->
    </header>

    <nav class="navbar">
    <button class="menu-btn" id="menuBtn">&#9776;</button>
    <h2 style="margin-left: 12px;"></h2>
    </nav>

  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="user-section">
      {% if user %}
        <button class="user-btn" onclick="toggleUserMenu()">üë§ {{ user }} ‚ñæ</button>
        <div class="user-dropdown" id="userMenu">
          <a href="{{ url_for('logout') }}">Logout</a>
        </div>
      {% else %}
        <button class="user-btn" onclick="toggleUserMenu()">üë§ Guest ‚ñæ</button>
        <div class="user-dropdown" id="userMenu">
          <a href="{{ url_for('auth', mode='login') }}">Login</a>
          <a href="{{ url_for('auth', mode='register') }}">Register</a>
        </div>
      {% endif %}
    </div>


    <a href="#">Trang ch·ªß</a>
    <a href="#">Th·ªëng k√™ k√™nh</a>
    <a href="#">Ph√¢n t√≠ch video</a>
    <a href="#">C√†i ƒë·∫∑t</a>
  </div>

  <!-- Overlay -->
  <div class="overlay" id="overlay"></div>

    <main class="container">
      <!-- Th√¥ng tin t·ªïng quan -->
      <section class="summary">

        <div class="stat-card">
          <h3>T·ªïng s·ªë view</h3>
          <p id="totalViews">--</p>
        </div>

        <div class="stat-card">
          <h3>T·ªïng s·ªë subscribe</h3>
          <p id="totalSubs">--</p>
        </div>

        <div class="stat-card">
          <h3>T·ªïng s·ªë channel</h3>
          <p id="totalChannels">--</p>
        </div>
      </section>

      <!-- Bi·ªÉu ƒë·ªì -->
      <section class="charts-wrapper">
        <div class="charts">

          <div class="chart-card">
            <h2>üìà Bi·ªÉu ƒë·ªì l∆∞·ª£t xem</h2>
            <canvas id="viewsChart"></canvas>
          </div>

          <div class="chart-card">
            <h2>üë• Bi·ªÉu ƒë·ªì ng∆∞·ªùi ƒëƒÉng k√Ω</h2>
            <canvas id="subsChart"></canvas>
          </div>

          <div class="toggle-button-container">
            <div class="chart-controls">
              <label for="numInput" class="num-label"><strong>Nh·∫≠p s·ªë k√™nh mu·ªën xem:</strong></label>
              <input type="number" id="numInput" value="5" min="1" max="50" style="width:80px; margin-right:10px;"> 
            </div>

            <div>
              <button id="toggleRankBtn" class="btn btn-primary">Xem k√™nh th·∫•p nh·∫•t</button>
            </div>            
          </div>
          
        </div>
      </section>

      <!-- B·∫£ng Top List -->
      <section class="toplist-section">
        <h2>üèÜ Danh s√°ch c√°c k√™nh ƒë∆∞·ª£c g√°n nh√£n</h2>

      <!-- ‚úÖ B·ªô l·ªçc th·ªÉ lo·∫°i theo ch·ªß ƒë·ªÅ -->
        <form method="GET" action="/" class="filter-form">
          <label for="category"><strong>Ch·ªçn th·ªÉ lo·∫°i:</strong></label>
          <select name="category" id="category" onchange="this.form.submit()">
            <option value="ALL" {% if not selected_category or selected_category == 'ALL' %}selected{% endif %}>
              -- All --
            </option>
            <option value="KID" {% if selected_category == 'KID' %}selected{% endif %}>Kid</option>
            <option value="MUSIC" {% if selected_category == 'MUSIC' %}selected{% endif %}>Music</option>
            <option value="TECH" {% if selected_category == 'TECH' %}selected{% endif %}>Tech</option>
            <option value="FOOD" {% if selected_category == 'FOOD' %}selected{% endif %}>Food</option>
          </select>
        </form>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th style="padding-left: 45px;">Channels</th>
                <th style="padding-left: 45px;">Views</th>
                <th style="padding-left: 10px;">Subscribers</th>
                <th>
                  <div class="label-header">
                    <span>Final Label</span>
                    <button id="help-btn" title="Gi·∫£i th√≠ch nh√£n">?</button>
                  </div>
                </th>
              </tr>
            </thead>

            <tbody>
              {% for row in data %}
              <tr>
                <td style="display: flex; align-items: center; gap: 10px;">
                  <!-- ·∫¢nh ƒë·∫°i di·ªán -->
                  <img src="{{ row.thumbnails.default.url }}" alt="{{ row.name }}" width="40" height="40" style="border-radius: 50%;">

                  <!-- T√™n k√™nh (click d·∫´n link YouTube) -->
                  <a href="https://youtube.com/{{ row.customUrl }}" 
                    target="_blank" 
                    style="text-decoration: none; color: #000000; font-weight: 500;">
                    {{ row.name }}
                  </a>
                </td>

                <td>{{ "{:,}".format(row.views) }}</td>
                <td>{{ "{:,}".format(row.subscribers) }}</td>
                <td class="{{ row.FinalLabel }}">{{ row.FinalLabel }}</td>
              </tr>
              {% endfor %}
            </tbody>

          </table>
        </div>
      </section>

      <section>
        <div class="label-filters">
          <button class="filter-btn viral-filter-btn" data-label="Viral">Viral</button>
          <button class="filter-btn trend-filter-btn" data-label="Trend">Trend</button>
          <button class="filter-btn developing-filter-btn" data-label="Developing">Developing</button>
          <button class="filter-btn notviral-filter-btn" data-label="NotViral">NotViral</button>
        </div>
      </section>

    </main>


    <nav class="navbarf"></nav>

    <footer>
      <h3>Copyright ¬©DA_HK251_2025</h3>
    </footer>

    <!-- JS -->
    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
  </body>
</html>
